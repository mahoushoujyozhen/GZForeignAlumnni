import{x as h,U as F,T as B,u as D,q as C,j as b,s as y,m as o,r as i,o as w,d as A,f as n,g as d,F as E,p as S,i as v,e as g,h as _}from"./vendor.e1400650.js";import{_ as V,a as T}from"./index.11841eca.js";const j=h({components:{UserOutlined:F,LockOutlined:B},setup(){const u=D(),t=C(),r=b({username:"",password:""});y(()=>{fetch("api/user/is_login",{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json"}),redirect:"follow"}).then(e=>(console.log(e),e.json())).then(e=>{if(console.log(e),!e){o.error("null response");return}if(t.query.act_id!==void 0){a();return}if(e.status==201){o.success("\u7BA1\u7406\u5458\u8D26\u53F7\u5DF2\u767B\u5F55"),u.push("managerCenter");return}if(e.status==202){o.success("\u8D26\u53F7\u5DF2\u767B\u5F55"),u.push("memberCenter");return}}).catch(e=>{console.log(e),o.error(e)})});const p=()=>{let l=r.username.replace(/(^\s*)|(\s*$)/g,""),e=r.password.replace(/(^\s*)|(\s*$)/g,"");fetch("api/user/login",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json"}),redirect:"follow",body:JSON.stringify({username:l,password:e})}).then(s=>(console.log(s),s.json())).then(s=>{if(console.log(s),!s){o.error("null response");return}if(s.status==-20004){o.error("\u5BC6\u7801\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01");return}if(t.query.act_id!==void 0){a();return}s.data.username=="admin"?(o.success("\u7BA1\u7406\u5458\u8D26\u53F7\u767B\u5F55\u6210\u529F"),u.push("/managerCenter")):(o.success("\u7528\u6237\u8D26\u53F7\u767B\u5F55\u6210\u529F"),u.push("/memberCenter"))}).catch(s=>{console.log(s),o.error(s)})},a=()=>{fetch("api/user/signIn",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:new Headers({"Content-Type":"application/json"}),redirect:"follow",body:JSON.stringify({act_id:t.query.act_id})}).then(e=>(console.log(e),e.json())).then(e=>{if(console.log("v=",e),console.log("v.data=",e.data),!e){o.error("null response"),console.log(e.status);return}if(e.status!==0){o.error(e.msg),console.log(e.msg),console.log(e.status);return}if(e.data.isApplied===!1){console.log("\u7528\u6237\u672A\u62A5\u540D"),o.warning("\u672A\u62A5\u540D\u8BE5\u6D3B\u52A8"),u.push("/memberCenter");return}if(e.data.isOver===!0){console.log("\u6D3B\u52A8\u5DF2\u7ED3\u675F"),o.warning("\u6D3B\u52A8\u5DF2\u7ED3\u675F"),u.push("/memberCenter");return}if(e.data.isSignIn===!0){console.log("\u7528\u6237\u5DF2\u7B7E\u5230"),o.success("\u5DF2\u7B7E\u5230"),u.push("/memberCenter");return}console.log(e.status,e.msg),o.success("\u7B7E\u5230\u6210\u529F"),u.push("/memberCenter")}).catch(e=>{console.log(e),o.error(e)})};return{postData:r,onFinish:p,Signin:a}}}),O=u=>(S("data-v-2cb3e98a"),u=u(),v(),u),$=O(()=>g("img",{src:T},null,-1)),q={class:"button"},I=_("\u7528\u6237\u767B\u5F55"),k=_("\u8D26\u53F7\u6CE8\u518C");function N(u,t,r,p,a,l){const e=i("van-field"),m=i("van-cell-group"),s=i("van-button"),f=i("van-form");return w(),A(E,null,[$,n(f,{onSubmit:t[2]||(t[2]=c=>u.onFinish()),class:"form"},{default:d(()=>[n(m,{inset:""},{default:d(()=>[n(e,{modelValue:u.postData.username,"onUpdate:modelValue":t[0]||(t[0]=c=>u.postData.username=c),name:"\u7528\u6237\u540D",label:"\u7528\u6237\u540D",placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}]},null,8,["modelValue"]),n(e,{modelValue:u.postData.password,"onUpdate:modelValue":t[1]||(t[1]=c=>u.postData.password=c),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"])]),_:1}),g("div",q,[n(s,{block:"",type:"primary","native-type":"submit"},{default:d(()=>[I]),_:1}),n(s,{block:"",plain:"",type:"primary",to:"register"},{default:d(()=>[k]),_:1})])]),_:1})],64)}var L=V(j,[["render",N],["__scopeId","data-v-2cb3e98a"]]);export{L as default};
